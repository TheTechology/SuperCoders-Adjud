<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="VÃ¢nÄƒtorii de È˜tiri False ğŸš€ - un program educaÈ›ional interactiv pentru elevi.">
  <title>VÃ¢nÄƒtorii de È˜tiri False ğŸš€</title>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      background: #f7faf9;
      color: #1f2937;
    }
    header {
      background: #047857;
      color: #fff;
      text-align: center;
      padding: 1.2rem;
    }
    main {
      padding: 1.2rem;
      max-width: 900px;
      margin: auto;
    }
    .card {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      padding: 16px;
      margin-bottom: 1rem;
    }
    .section-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.2rem;
      font-weight: bold;
      color: #065f46;
      margin-bottom: 10px;
    }
    .pill {
      background: #ecfdf5;
      border-radius: 10px;
      padding: 4px 8px;
      font-size: 1rem;
    }
    .btn {
      background: #047857;
      color: #fff;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s;
    }
    .btn:hover {
      background: #065f46;
    }
    .green {
      background: #059669;
    }
    .small {
      font-size: 0.9rem;
      line-height: 1.4;
    }

    /* --- AI Detector responsive tweak --- */
    @media (min-width:740px){
      #ai-grid{grid-template-columns:1.2fr .8fr}
    }
  </style>
</head>

<body>
  <header>
    <h1>VÃ¢nÄƒtorii de È˜tiri False ğŸš€</h1>
    <p>Un program educaÈ›ional interactiv pentru elevi</p>
  </header>

  <main>
    <!-- Alte secÈ›iuni existente ale proiectului -->
    <section class="card">
      <div class="section-title"><span class="pill">ğŸ’¡</span> <h3>Despre program</h3></div>
      <p>Prin acest program, copiii Ã®nvaÈ›Äƒ cum sÄƒ recunoascÄƒ informaÈ›iile false, sÄƒ verifice surse È™i sÄƒ gÃ¢ndesc critic.</p>
    </section>

    <!-- Detector educaÈ›ional de imagini AI -->
    <section id="ai-detector" class="card" style="scroll-margin-top:80px">
      <div class="section-title">
        <span class="pill">ğŸ§ª</span><h3 style="margin:0">Detector educaÈ›ional de imagini AI (on-device)</h3>
      </div>

      <p class="small">
        ÃncarcÄƒ o imagine È™i vei primi un <strong>scor educaÈ›ional</strong> bazat pe cÃ¢teva indicii: existenÈ›a metadatelor EXIF,
        cÃ¢t de â€netedÄƒâ€/â€asprÄƒâ€ e imaginea, artefacte la text mic È™i contururi. Rezultatul nu este o dovadÄƒ absolutÄƒ â€”
        e un instrument pentru discuÈ›ii È™i Ã®nvÄƒÈ›are criticÄƒ.
      </p>

      <div class="card" style="background:#f6fffa">
        <div style="display:flex;flex-wrap:wrap;gap:10px;align-items:center">
          <input id="ai-file" type="file" accept="image/*"
                 style="flex:1;min-width:220px;padding:10px;border:1px solid rgba(6,95,70,.12);border-radius:10px;background:#fff" />
          <button class="btn green" id="ai-run">AnalizeazÄƒ imaginea</button>
        </div>

        <div style="display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px" id="ai-grid">
          <canvas id="ai-canvas" style="width:100%;max-width:100%;background:#fff;border:1px dashed rgba(6,95,70,.18);border-radius:10px"></canvas>
          <div class="card small" id="ai-report" style="background:#fffdf7">
            ÃncarcÄƒ o imagine È™i apasÄƒ <strong>AnalizeazÄƒ</strong>.
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:12px;background:#fff8f2">
        <h4 class="game-title" style="margin:0 0 6px">Rolul È™i obiectivele modulului</h4>
        <ul class="small" style="margin:0 0 0 18px">
          <li><strong>Rol:</strong> sÄƒ Ã®nvÄƒÈ›Äƒm <em>cum</em> sÄƒ observÄƒm indicii vizuale È™i sÄƒ punem Ã®ntrebÄƒri corecte, nu sÄƒ â€condamnÄƒmâ€ o imagine.</li>
          <li><strong>Obiectiv 1:</strong> elevii explicÄƒ Ã®n cuvintele lor ce sunt metadatele EXIF È™i de ce pot lipsi.</li>
          <li><strong>Obiectiv 2:</strong> elevii identificÄƒ indicii vizuale (netezime excesivÄƒ, halouri, contururi rupte).</li>
          <li><strong>Obiectiv 3:</strong> elevii propun paÈ™i de verificare: cÄƒutare inversÄƒ, sursÄƒ originalÄƒ, context.</li>
        </ul>
      </div>
    </section>
  </main>

  <script>
    // ===== AI IMAGE DETECTOR (educational) =====
    (function(){
      const fi = document.querySelector('#ai-file');
      const run = document.querySelector('#ai-run');
      const cvs = document.querySelector('#ai-canvas');
      const rep = document.querySelector('#ai-report');
      if(!fi || !run || !cvs || !rep) return;

      const ctx = cvs.getContext('2d');

      async function hasEXIF(file){
        try{
          const buf = await file.slice(0, 64*1024).arrayBuffer();
          const view = new DataView(buf);
          if(view.getUint16(0) != 0xFFD8) return false;
          for(let i=2;i<view.byteLength-1;i++){
            if(view.getUint16(i) === 0xFFE1) return true;
          }
          return false;
        }catch{ return false; }
      }

      function edgeVariance(imageData){
        const {data, width, height} = imageData;
        const k = [0,1,0,1,-4,1,0,1,0];
        const out = new Float32Array(width*height);
        const get=(x,y)=>{
          const i=(y*width+x)*4;
          return 0.299*data[i] + 0.587*data[i+1] + 0.114*data[i+2];
        };
        for(let y=1;y<height-1;y++){
          for(let x=1;x<width-1;x++){
            let acc=0, t=0;
            for(let ky=-1; ky<=1; ky++){
              for(let kx=-1; kx<=1; kx++){
                acc += get(x+kx, y+ky) * k[++t-1];
              }
            }
            out[y*width+x]=acc;
          }
        }
        let sum=0, sum2=0, n=out.length;
        for(let i=0;i<n;i++){ const v=out[i]; sum+=v; sum2+=v*v; }
        const mean=sum/n;
        const variance = (sum2/n) - (mean*mean);
        return variance;
      }

      function haloScore(imageData){
        const {data, width, height} = imageData;
        const blur = new Uint8ClampedArray(data.length);
        const get=(x,y,c)=> data[(y*width+x)*4 + c];
        const set=(arr,x,y,c,val)=> arr[(y*width+x)*4 + c] = val;
        for(let y=1;y<height-1;y++){
          for(let x=1;x<width-1;x++){
            for(let c=0;c<3;c++){
              let s=0;
              for(let ky=-1; ky<=1; ky++){
                for(let kx=-1; kx<=1; kx++){
                  s += get(x+kx, y+ky, c);
                }
              }
              set(blur,x,y,c, Math.round(s/9));
            }
            set(blur,x,y,3,255);
          }
        }
        let diff=0, count=0;
        for(let i=0;i<data.length;i+=4){
          const lum = 0.299*data[i]+0.587*data[i+1]+0.114*data[i+2];
          const bl  = 0.299*blur[i]+0.587*blur[i+1]+0.114*blur[i+2];
          diff += Math.abs(lum - bl);
          count++;
        }
        return diff / count;
      }

      async function analyze(){
        const file = fi.files && fi.files[0];
        if(!file){ rep.innerHTML='Te rog alege o imagine.'; return; }

        const img = new Image();
        img.onload = async ()=>{
          const maxSide = 768;
          let w=img.naturalWidth, h=img.naturalHeight;
          const scale = Math.min(1, maxSide/Math.max(w,h));
          w = Math.max(1, Math.round(w*scale));
          h = Math.max(1, Math.round(h*scale));
          cvs.width=w; cvs.height=h;
          ctx.drawImage(img,0,0,w,h);
          const id = ctx.getImageData(0,0,w,h);

          const exif = await hasEXIF(file);
          const ev = edgeVariance(id);
          const halo = haloScore(id);
          const smoothness = 1/(1+ev);
          let scoreAI = 0;
          if(!exif) scoreAI += 35;
          const smoothPct = Math.min(40, Math.max(0, (smoothness*100)) );
          const haloPct   = Math.min(25, Math.max(0, (halo/20)) );
          scoreAI += smoothPct + haloPct;
          scoreAI = Math.max(0, Math.min(100, Math.round(scoreAI)));

          const badges = [];
          badges.push(exif ? 'ğŸ“ EXIF: prezent (posibil original sau foto editatÄƒ)' : 'ğŸ“ EXIF: lipsÄƒ (posibil export/app, uneori AI)');
          badges.push(`ğŸ§± Muchii/Asprime: ${ev.toFixed(1)} (mai mic â‰ˆ mai neted)`);
          badges.push(`âœ¨ Halouri/Contururi: ${halo.toFixed(1)} (mai mare â‰ˆ potenÈ›iale artefacte)`);

          let verdict = '';
          if(scoreAI >= 70) verdict = 'âš ï¸ Mare probabilitate educaÈ›ionalÄƒ de generare AI. VerificÄƒ sursa!';
          else if(scoreAI >= 40) verdict = 'â„¹ï¸ Indicii mixte. ContinuÄƒ cu verificÄƒri suplimentare (cÄƒutare inversÄƒ).';
          else verdict = 'âœ… PuÈ›ine indicii de generare AI. TotuÈ™i, verificÄƒ sursa pentru siguranÈ›Äƒ.';

          rep.innerHTML = `
            <div class="small">
              <div style="font-weight:900;margin-bottom:6px">Scor educaÈ›ional AI: <span style="font-size:18px">${scoreAI}/100</span></div>
              <div style="display:flex;flex-direction:column;gap:4px;margin-bottom:8px">
                ${badges.map(b=>`<div>â€¢ ${b}</div>`).join('')}
              </div>
              <div class="card" style="background:#f9fffb;margin-bottom:8px">${verdict}</div>
              <div><strong>PaÈ™i recomandaÈ›i:</strong>
                <ul style="margin:6px 0 0 18px">
                  <li>FÄƒ <em>cÄƒutare inversÄƒ</em> a imaginii (Google/Bing/Yandex).</li>
                  <li>CautÄƒ <em>sursa originalÄƒ</em> È™i <em>contextul</em> publicÄƒrii.</li>
                  <li>AnalizeazÄƒ <em>mÃ¢inile, textul mic, bijuteriile</em> â€” apar adesea deformÄƒri.</li>
                </ul>
              </div>
            </div>`;
        };
        img.onerror = ()=>{ rep.textContent='Nu am putut Ã®ncÄƒrca imaginea.'; };
        img.src = URL.createObjectURL(file);
      }

      run.addEventListener('click', analyze);
    })();
  </script>
</body>
</html>
